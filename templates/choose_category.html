{% extends "base.html" %}

{% block title %}Choose Category{% endblock %}

{% block extra_styles %}
    <style>
        /* Styling for the "Back" button */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background-color: #343a40;
            color: white;
            border-radius: 30px;
            font-size: 18px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .back-button:hover {
            background-color: #495057;
        }

        .back-button i {
            margin-right: 8px;
        }
    </style>
{% endblock %}

{% block pre_content %}
    <!-- Back Button -->
    <div class="back-button" onclick="window.history.back()">
        <i class="fas fa-arrow-left"></i> Back
    </div>
{% endblock %}

{% block content %}
    <h1 class="text-center my-4">Choose Voting Category</h1>

    {% if category == 'restaurant' %}
        <!-- Restaurant voting section -->
        <form method="POST" action="{{ url_for('start_restaurant_election') }}">
            <div class="form-group">
                <label for="city">City</label>
                <input type="text" class="form-control mb-2" id="city" name="city" required>
            </div>
            <div class="form-group">
                <label for="state">State</label>
                <input type="text" class="form-control mb-2" id="state" name="state" required>
            </div>
            <div class="form-group">
                <label for="number_of_restaurants">Number of Restaurants</label>
                <input type="number" class="form-control mb-2" id="number_of_restaurants" name="number_of_restaurants" min="1" required>
            </div>
            <div class="form-group">
                <label for="max_votes">Maximum Votes</label>
                <input type="number" class="form-control mb-2" id="max_votes" name="max_votes" min="1" required>
            </div>
            <button type="submit" name="generate_restaurants" value="generate_restaurants" class="btn btn-warning btn-block mb-2">Generate Restaurants</button>
        </form>
    {% elif category == 'custom' %}
        <!-- Custom candidate voting section -->
        <form method="POST" action="{{ url_for('start_custom_election') }}">
            <div class="form-group">
                <label for="number_of_custom_candidates">Number of Candidates</label>
                <input type="number" class="form-control mb-2" id="number_of_custom_candidates" name="number_of_custom_candidates" min="1" required oninput="generateCandidateFields()">
            </div>

            <div id="custom_candidates_container"></div> <!-- Container for dynamic candidate fields -->

            <div class="form-group">
                <label for="max_votes_custom">Maximum Votes</label>
                <input type="number" class="form-control mb-2" id="max_votes_custom" name="max_votes_custom" min="1" required>
            </div>

            <button type="submit" class="btn btn-primary btn-block mb-2">Start Election with Custom Candidates</button>
        </form>
    {% endif %}
{% endblock %}

{% block extra_scripts %}
    <!-- FontAwesome for arrow icon -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Function to dynamically generate candidate input fields
        function generateCandidateFields() {
            const numCandidates = document.getElementById('number_of_custom_candidates').value;
            const candidatesContainer = document.getElementById('custom_candidates_container');
            candidatesContainer.innerHTML = ""; // Clear previous candidate fields

            // Generate input fields based on the user's input
            for (let i = 0; i < numCandidates; i++) {
                const inputField = document.createElement('input');
                inputField.type = 'text';
                inputField.name = `candidate_${i + 1}`;
                inputField.classList.add('form-control', 'mb-2');
                inputField.placeholder = `Enter Candidate ${i + 1}`;
                inputField.required = true;
                candidatesContainer.appendChild(inputField);
            }
        }
    </script>
    
    <!-- Include shooting-stars.js -->
    <script src="{{ url_for('static', filename='shooting-stars.js') }}"></script>
{% endblock %}
